<!DOCTYPE html>
<html>
<head>
  <title>dom_test.html</title>
  <script src="bot-bootstrap.js" type="text/javascript"></script>
  <script type="text/javascript">
    goog.require('bot.dom');
    goog.require('bot.locators');
    goog.require('goog.events.EventType');
    goog.require('goog.testing.jsunit');
  </script>

  <script type="text/javascript">
    function testHasAttributeShouldWorkWithWellKnownDefaultProperties() {
      var chips = bot.locators.findElement({id: 'chips'});
      var peas = bot.locators.findElement({id: 'peas'});

      assertTrue(bot.dom.hasAttribute(chips, 'selected'));
      assertTrue(bot.dom.hasAttribute(peas, 'selected'));
    }

    function testCanFindNamedAttributes() {
      var e = bot.locators.findElement({id: 'cheddar'});

      assertEquals('cheese1', bot.dom.getAttribute(e, 'name'));
    }

    function testCanFindAttributesOnTheExpando() {
      var e = bot.locators.findElement({id: 'cheddar'});

      assertEquals('lovely', bot.dom.getAttribute(e, 'unknown'));
    }

    function testSelectedShouldBeFalseIfNotSet() {
      var chips = bot.locators.findElement({id: 'chips'});

      var result = bot.dom.getAttribute(chips, 'selected');
      assertTrue(goog.isBoolean(result));
      assertFalse(result);
    }

    function testSelectedShouldBeReturnedAsABooleanWhenValueNotOnAttribute() {
      var e = bot.locators.findElement({id: 'peas'});

      var result = bot.dom.getAttribute(e, 'selected');
      assertTrue(goog.isBoolean(result));
      assertTrue(result);
    }

    function testReturnsNullWhenSelectedAttributeCannotBeSet() {
      var e = bot.locators.findElement({id: 'cheddar'});

      assertEquals(null, bot.dom.getAttribute(e, 'selected'));
    }

    function testShouldAliasClassNameAttribute() {
      var e = bot.locators.findElement({id: 'brie'});

      assertEquals('tasty', bot.dom.getAttribute(e, 'class'));
      assertEquals('tasty', bot.dom.getAttribute(e, 'className'));
    }

    function testShouldReturnNullForMissingAttributes() {
      var e = bot.locators.findElement({id: 'brie'});

      assertNull(bot.dom.getAttribute(e, 'never_there'));
    }

    function testShouldReturnAnEmptyStringWhenAnAttributesValueIsAnEmptyString() {
      var e = bot.locators.findElement({id: 'gouda'});

      assertEquals('', bot.dom.getAttribute(e, 'empty'));
    }

    function testShouldFailToFindAnAttributeWhenTheAttributeNameIsNotSpecified() {
      var e = bot.locators.findElement({id: 'gouda'});

      try {
        bot.dom.getAttribute(e);
        fail('Should never get this far');
      } catch (e) {
        // though this is expected
      }
    }

    function testShouldFailToFindAnAttributeWhenTheElementIsNotSpecified() {
      try {
        bot.dom.getAttribute(undefined, 'tagName');
        fail('Should never get this far');
      } catch (e) {
        // though this is expected
      }
    }

    function testIsSelectedShouldReturnTrueForSelectedElements() {
      var selected = bot.locators.findElement({id: 'peas'});
      var notSelected = bot.locators.findElement({id: 'chips'});
      var checky = bot.locators.findElement({name: 'checky'});
      var notChecky = bot.locators.findElement({name: 'notChecky'});

      assertTrue(bot.dom.isSelected(selected));
      assertTrue(bot.dom.isSelected(checky));
      assertFalse(bot.dom.isSelected(notSelected));
      assertFalse(bot.dom.isSelected(notChecky));
    }

    function testShouldBeAbleToDetermineIfAnElementIsLocatedWithinHead() {
      var head = goog.dom.getElementsByTagNameAndClass('HEAD')[0];
      var title = goog.dom.getElementsByTagNameAndClass('TITLE')[0];
      var selected = goog.dom.$('peas');
      var notSelected = goog.dom.$('chips');

      assertNotUndefined('head not found!', head);
      assertNotUndefined('title not found!', title);

      assertTrue(bot.dom.isInHead(head));
      assertTrue(bot.dom.isInHead(title));
      assertFalse(bot.dom.isInHead(document));
      assertFalse(bot.dom.isInHead(document.body));
      assertFalse(bot.dom.isInHead(document.documentElement));
      assertFalse(bot.dom.isInHead(selected));
      assertFalse(bot.dom.isInHead(notSelected));
    }


    function testAnElementNotAttachedToTheDomShouldNotBeConsideredInHead() {
      assertFalse(bot.dom.isInHead(goog.dom.createElement('DIV')));
    }
  </script>
</head>
<body>
  <div name="cheese1" id="cheddar" unknown="lovely">Cheddar</div>
  <div name="cheese2" id="brie" class="tasty">Brie</div>
  <div name="cheese3" id="gouda" empty="">Gouda</div>

  <form action="#" method="get" name="myform">
    <select name="fish_supper">
      <option value="fish">Fish</option>
      <option id="chips" value="chips">Chips</option>
      <option id="peas"  value="peas" selected>Mushy Peas</option>
      <option value="gravy">Gravy</option>
    </select>

    <input name="checky" type="checkbox" checked="cheese" />
    <input name="notChecky" type="checkbox" />
    <input name="radio" id="unchecked" type="radio" value="me">Me
    <input name="radio" id="checked" type="radio" value="myself" checked="checked">Myself
    <input name="radio" type="radio" value="i">And I
  </form>
</body>
</html>