<!DOCTYPE html>
<html>
<head>
  <title>locator_test.html</title>
  <script src="bot-bootstrap.js"></script>
  <script>
    goog.require('goog.testing.jsunit');
    goog.require('goog.events.EventType');
    goog.require('bot.locators');
  </script>

  <script>
    function testCanFindById() {
      var e = bot.locators.findElement({id: 'x'});

      assertEquals('para', e.getAttribute('name'));
    }

    function testCanFindByIdWhenElementIsAfterOneWithSameName() {
      var e = bot.locators.findElement({id: 'after'});

      assertEquals('right', e.getAttribute('name'));
    }

    function testCanFindByNameOutsideOfAForm() {
      var e = bot.locators.findElement({name: 'para'});

      assertEquals('x', e.getAttribute('id'));
    }

    function testWillNotFindAnElementByNameWhereNoMatchShouldBeFound() {
      assertNull(bot.locators.findElement({name: 'foobar'}));
    }

    function testCanFindByClassName() {
      var dogs = bot.locators.findElement({className: 'dogs'});
      assertNotNull(dogs);
      assertEquals('after', dogs.id);
    }

    function testCannotSearchWithCompoundClassNames() {
      assertThrows(goog.bind(bot.locators.findElement, null,
          {className: 'feline cats'}));
    }

    function testFindByClassNameReturnsFirstMatchingElement() {
      var cats = bot.locators.findElement({className: 'cats'});
      assertNotNull(cats);
      assertEquals('wrong', cats.id);
    }

    function testCanFindByAnyOfAnElementsClassNames() {
      var felines = bot.locators.findElement({className: 'feline'});
      var cats = bot.locators.findElement({className: 'cats'});

      assertEquals(felines, cats);
      assertEquals('wrong', cats.id);
    }

    function testFindByClassNameReturnsNullIfNoMatchIsFound() {
      assertNull(bot.locators.findElement({className: 'catsAndDogs'}));
    }

    function testCanFindElementByCssSelector() {
      var after = bot.locators.findElement({css: '#wrong'});

      assertNotNull(after);
      assertEquals('wrong', after.id);
    }

    function testShouldReturnNullIfNoCssMatchIsFound() {
      assertNull(bot.locators.findElement({css: '#uglyfish'}))
    }

    function testWillRejectShouldRejectMultipleSelectors() {
      assertThrows(goog.bind(bot.locators.findElement, null,
          {css: '.one, #two'}));
    }

    function testCanLocateElementsUsingXPath() {
      var doggies = bot.locators.findElement({xpath: "//*[@id = 'after']"});

      assertNotNull(doggies);
      assertEquals('after', doggies.id);
    }

    function testWillReturnNullIfNoMatchUsingXPathIsFound() {
      assertNull(bot.locators.findElement({xpath: "//fish"}));
    }
  </script>
</head>
<body>
  <p id="x" name="para">Para</p>

  <div name="after" id="wrong" class="feline cats">nope</div>
  <div name="right" id="after" class="dogs">yup</div>
  <div name="lion" class="cats">simba</div>
</body>
</html>