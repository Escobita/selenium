<!DOCTYPE html>
<html>
<head>
  <title>keys_test</title>
  <script type="text/javascript"
          src="../webdriver-bootstrap.js"></script>
  <script type="text/javascript" src="deps.js"></script>
  <script type="text/javascript">
    goog.require('bot.events');
    goog.require('bot.keys');
    goog.require('goog.events.EventType');
    goog.require('goog.events.KeyCodes');
    goog.require('goog.testing.jsunit');
    goog.require('goog.userAgent');
  </script>
  <script type="text/javascript">
    /**
     * Sets the value of the given count box to its current value plus one.
     * If the current value is not a number, replaces it with "1".
     */
    function incrCount() {
      var countBox = document.getElementById('change_count');
      var curVal = countBox.value ? parseInt(countBox.value) : 0;
      countBox.value = curVal + 1;
    }

    /*
     * Types a value into textbox, and makes sure that textbox and textbox_count
     * have the correct values afterwards.  textbox_count should display the
     * number of times textbox's oninput (non IE) or onpropertychange (IE) event
     * fired.
     * @param {string} input Value to type into textbox.
     */
    function runTypingTest(input) {
      var inputIds = ['textbox', 'password', 'email', 'textarea'];
      var countBox = document.getElementById('change_count');

      for (var i = 0; i < inputIds.length; i++) {
        var inputBox = document.getElementById(inputIds[i]);
        inputBox.value = '';
        countBox.value = '';
        bot.keys.type(inputBox, input);
        assertEquals(input, inputBox.value);
        assertEquals('' + input.length, countBox.value);
      }
    }

    function testLowerCase() {
      runTypingTest('abcdefghijklmnopqrstuvwxyz');
    }

    function testUpperCase() {
      runTypingTest('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
    }

    function testNumbers() {
      runTypingTest('1234567890');
    }

    function testSymbols() {
      runTypingTest('`~!@#$%^&*()-_=+[{]}\\|;:\'"",<.>/?');
    }
  </script>
</head>
<body>
  The second textbox displays how often some of the events of the first textbox
  fire. <br>
  <form action="">
    <input type="text" id="textbox"
           oninput="incrCount();"
           onpropertychange="incrCount();">
    <input type="password" id="password"
           oninput="incrCount();"
           onpropertychange="incrCount();">
    <input type="email" id="email"
           oninput="incrCount();"
           onpropertychange="incrCount();">
    <textarea id="textarea"
           oninput="incrCount();"
           onpropertychange="incrCount();"></textarea>
    <input type="text" id="change_count">
  </form>
</body>
</html>

